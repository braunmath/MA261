<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="rhythms" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Rhythmic Patterns</title>

  <p>
    Our final topic of this chapter is an application of the Euclidean algorithm to the theory of musical rhythm.
    We will discuss in this section examples of rhythms and language to describe rhythms, which we will use to study a family of rhythms first described by Godfried Toussaint in 2005 and more fully developed by Toussaint and his coauthors in the following paper:
    <ul>
      <li>
        <p>
          Erik D. Demaine, Francisco Gomez-Martin, Henk Meijer, David Rappaport, Perouz Taslakian, Godfried T. Toussaint, Terry Winograd, David R. Wood,
The distance geometry of music,
Computational Geometry,
Volume 42, Issue 5,
2009,
Pages 429-454,
ISSN 0925-7721,
<url href="https://doi.org/10.1016/j.comgeo.2008.04.005">https://doi.org/10.1016/j.comgeo.2008.04.005</url>
        </p>
      </li>
    </ul>
    This paper is freely available at the doi link above, if you are interested in reading more details.
  </p>

  <p>
    We will begin by looking at four examples of rhythms, which will help us introduce the notation and language we will need.
  </p>

  <p>
    The first example we will consider is a rhythm known as the <alert>Cuban tresillo</alert>, though it is also found in the music of Central and West Africa as well as India.
    The tresillo consists of three beats during an eight-count, with beats occurring on counts 1, 4, and 7.
    We can represent this using a "box-like" representation as follows, where a "<m>\times</m>" denotes a beat onset and a "<m>\cdot</m>" represents a pause or quiet count:
    <me>
      [\times \cdot \cdot \times \cdot \cdot \times \cdot \, ]
    </me>
    We can also represent this rhythm using a "clockwise distance sequence" that records the lengths of the intervals between onsets; for a tresillo, this would be
    <me>
      (3,3,2)
    </me>
    where the final <m>2</m> represents the wrap-around from the last onset back to the first.
    Finally, we can represent this rhythm using a "clock diagram" as in the following figure.
  </p>

<figure>
  <caption>A clock diagram of the Cuban <em>tresillo</em> rhythm.</caption>
  <image width="65%">
    <shortdescription>A clock diagram of the Cuban tresillo rhythm.</shortdescription>
    <latex-image>
\begin{tikzpicture}[scale=3]

% radius
\def\R{1.2}

% outer 8-gon
\draw
  (90:\R)
  \foreach \k in {1,...,7} {
    -- ({90-360*\k/8}:\R)
  }
  -- cycle;

% thick triangle (vertices 1,4,7)
\draw[line width=1.5pt]
  (90:\R)         % 1
  -- (-180:\R)    % 7
  -- (-45:\R)       % 4
  -- cycle;
  
\fill[gray!60]
  (90:\R)         % 1
  -- (-180:\R)    % 7
  -- (-45:\R)       % 4
  -- cycle;

% vertices
\foreach \k in {0,...,7} {
  \ifnum\k=0
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else\ifnum\k=3
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else\ifnum\k=6
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else
    \draw ({90-360*\k/8}:\R) circle (0.035);
  \fi\fi\fi
}

% edge labels
\node at (135:0.95) {2};
\node at (10:0.55) {3};
\node at (-125:0.55) {3};

% labels 1--8
\foreach \k in {0,...,7} {
  \node[font=\small]
    at ({90-360*\k/8}:1.4) {\number\numexpr\k+1\relax};
}

\end{tikzpicture}
</latex-image>
  </image>
  </figure>


  <exercise>
    <p>
      As a class, we will (quietly) tap the tresillo rhythm together.
    </p>
  </exercise>

  <p>
    Motivated by the example above, we make the following precise definitions. 
  </p>

  <definition xml:id="def-rhythmnotation">
    <statement>
      <p>
        We consider rhythmic patterns of length <m>n</m> having <m>k</m> <alert>onsets</alert>, that is, <m>k</m> beats among <m>n</m> possible beats.
        The <alert>Time Unit Box System, or box-like</alert> representation is a sequence of <m>n</m> symbols consisting of <m>k</m> "<m>\times</m>" symbols and <m>n-k</m> "<m>\cdot</m>" symbols.
        The <alert>clockwise distance sequence</alert> representation is a sequence of <m>k</m> integers that sum up to <m>n</m> and represent the lengths of the (circular) distances between pairs of beat onsets.
        The <alert>clock diagram</alert> is a graphical representation of the rhythmic pattern on a circle with <m>n</m> equally spaced points labeled <m>1,\ldots,n</m> with special dots placed at the positions for beat onsets and the polygon formed from the beat onsets shaded.
      </p>
    </statement>
  </definition>

  <exercise>
    <p>
      A single representation is given for each of the following rhythms.
      Find the box-like, sequence, and clock diagram representations for each.
      <ul>
        <li>
          <p>
            <m>(1,4,4,3)</m>
          </p>
        </li>
        <li>
          <p>
            <m>[\times \times \cdot \cdot \cdot \cdot \times \cdot \cdot \times ]</m>
          </p>
        </li>
      </ul>
    </p>
  </exercise>

<p>
    The second example we will consider is the <alert>Cuban cinquillo</alert> rhythm, which is also known as the <alert>Malfuf</alert> rhythmic pattern of Egypt and the Korean <alert>Nong P'yon</alert> drum pattern.
    This is the rhythm with distance sequence <m>(2,1,2,1,2)</m> and box-like representation
    <md>
      [\times \cdot \times \times \cdot \times \times \cdot ]
    </md>
    The clock diagram for the cinquillo is below.
</p>

<figure>
  <caption>A clock diagram of the <em>cinquillo</em> rhythm.</caption>
  <image width="65%">
    <shortdescription>A clock diagram of the cinquillo rhythm.</shortdescription>
    <latex-image>
\begin{tikzpicture}[scale=3]

% radius
\def\R{1.2}

% outer 8-gon
\draw
  (90:\R)
  \foreach \k in {1,...,7} {
    -- ({90-360*\k/8}:\R)
  }
  -- cycle;

% thick pentagon
\draw[line width=1.5pt]
  (90:\R)         
  -- (-180:\R) 
  -- (-135:\R)    
  -- (-45:\R)    
  -- (0:\R)
  -- cycle;

\fill[gray!60]
  (90:\R)         
  -- (-180:\R) 
  -- (-135:\R)    
  -- (-45:\R)    
  -- (0:\R)
  -- cycle;

% vertices
\foreach \k in {0,...,7} {
  \ifnum\k=0
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else\ifnum\k=3
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else\ifnum\k=6
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else\ifnum\k=2
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else\ifnum\k=5
    \fill ({90-360*\k/8}:\R) circle (0.035);
  \else
    \draw ({90-360*\k/8}:\R) circle (0.035);
  \fi\fi\fi\fi\fi
}

% labels 1--8
\foreach \k in {0,...,7} {
  \node[font=\small]
    at ({90-360*\k/8}:1.4) {\number\numexpr\k+1\relax};
}
\end{tikzpicture}
</latex-image>
  </image>
  </figure>

    <exercise>
    <p>
      As a class, we will (quietly) tap the cinquillo rhythm together.
    </p>
  </exercise>



  <p>
    The third example we will consider is the <alert>clave son</alert> rhythm, with sequence <m>(3,3,4,2,4)</m> and box-like representation
    <md>
      [\times \cdot \cdot \times \cdot \cdot \times \cdot \cdot \cdot \times \cdot \times \cdot \cdot \, \cdot ] 
    </md>
    
  </p>

<figure>
  <caption>A clock diagram of the <em>clave son</em> rhythm.</caption>
  <image width="65%">
    <shortdescription>A clock diagram of the clave son rhythm.</shortdescription>
    <latex-image>
\begin{tikzpicture}[scale=3]

% radius
\def\R{1.2}

% outer 16-gon
\draw
  (90:\R)
  \foreach \k in {1,...,15} {
    -- ({90-360*\k/16}:\R)
  }
  -- cycle;

% shaded pentagon: vertices 1,4,7,11,13
\fill[gray!60]
  (90:\R)        % 1
  -- (22.5:\R)   % 4
  -- (-45:\R)    % 7
  -- (-135:\R)   % 11
  -- (-180:\R)    % 13
  -- cycle;

% pentagon outline
\draw[thick]
  (90:\R)
  -- (22.5:\R)
  -- (-45:\R)
  -- (-135:\R)
  -- (180:\R)
  -- cycle;

% vertices (filled = pentagon vertices)
\foreach \k in {0,...,15} {
  \ifnum\k=0
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=3
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=6
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=10
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=12
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else
    \draw ({90-360*\k/16}:\R) circle (0.03);
  \fi\fi\fi\fi\fi
}

% labels: 1--16
\foreach \k in {0,...,15} {
  \node[font=\small]
    at ({90-360*\k/16}:1.35) {\number\numexpr\k+1\relax};
}

\end{tikzpicture}
</latex-image>
  </image>
  </figure>

    <exercise>
    <p>
      As a class, we will (quietly) tap the clave son rhythm together.
    </p>
  </exercise>


  <p>
    The fourth example we will consider is the <alert>Bossa-Nova</alert> rhythm from Brazil, with sequence <m>(3,3,4,3,3)</m> and box-like representation
    <md>
      [\times \cdot \cdot \times \cdot \cdot \times \cdot \cdot \cdot \times \cdot \cdot \times \cdot \, \cdot ]
    </md>
  </p>

<figure>
  <caption>A clock diagram of the <em>Bossa-Nova</em> rhythm.</caption>
  <image width="65%">
    <shortdescription>A clock diagram of the Bossa-Nova rhythm.</shortdescription>
    <latex-image>
\begin{tikzpicture}[scale=3]

% radius
\def\R{1.2}

% outer 16-gon
\draw
  (90:\R)
  \foreach \k in {1,...,15} {
    -- ({90-360*\k/16}:\R)
  }
  -- cycle;

% shaded pentagon: vertices 1,4,7,11,14
\fill[gray!60]
  (90:\R)        % 1
  -- (22.5:\R)   % 4
  -- (-45:\R)    % 7
  -- (-135:\R)   % 11
  -- (180-22.5:\R)    % 14
  -- cycle;

% pentagon outline
\draw[thick]
  (90:\R)
  -- (22.5:\R)
  -- (-45:\R)
  -- (-135:\R)
  -- (180-22.5:\R)
  -- cycle;

% vertices (filled = pentagon vertices)
\foreach \k in {0,...,15} {
  \ifnum\k=0
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=3
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=6
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=10
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else\ifnum\k=13
    \fill ({90-360*\k/16}:\R) circle (0.03);
  \else
    \draw ({90-360*\k/16}:\R) circle (0.03);
  \fi\fi\fi\fi\fi
}

% labels: 1--16
\foreach \k in {0,...,15} {
  \node[font=\small]
    at ({90-360*\k/16}:1.35) {\number\numexpr\k+1\relax};
}

\end{tikzpicture}
</latex-image>
  </image>
  </figure>

    <exercise>
    <p>
      As a class, we will (quietly) tap the Bossa-Nova rhythm together.
    </p>
  </exercise>

  <p>
    There is a difference between the clave son and the Bossa-Nova rhythm; they have the same number of onsets in the same time, but the spacing is different.
    The clave son seems less "evenly-spaced" than the Bossa-Nova, and this can be made mathematically precise using the following definition.
  </p>

  <definition xml:id="def-maximallyeven">
    <statement>
      <p>
        The clock diagram for a rhythm <m>R</m> consists of <m>k</m> designated points for the beat onsets chosen from the <m>n</m> points on the unit circle given by
        <md>
          \{(\cos(\pi/2-2\pi(i-1)/n),\sin(\pi/2-2\pi(i-1)/n)):i=1,2,\ldots,n\}\, ,
        </md>
        which are the <m>n</m> points of a regular polygon with a vertex at the point <m>(0,1)</m> corresponding to <m>i=1</m>.
        We define the point 
        <me>
          P_i:=(\cos(\pi/2-2\pi(i-1)/n),\sin(\pi/2-2\pi(i-1)/n))\, .
        </me>
        If <m>R\subseteq \{1,2,3,\ldots,n\}</m>, we define the <alert>sum of pairwise distance function</alert> for <m>R</m> to be 
        <md>
          \mathrm{pairdist}(R):=\sum_{\{i,j\}\subset R}\textrm{dist}(P_i,P_j)
        </md>
        where <m>\textrm{dist}</m> is the usual distance function in <m>\R^2</m>.
        A rhythm with <m>k</m> onsets among <m>n</m> possible beats is <alert>maximally even</alert> if the value of the sum of pairwise distances is maximum among all rhythms with <m>k</m> onsets among <m>n</m> possible beats.
      </p>
    </statement>
  </definition>

  <p>
    The intuition for using the sum of pairwise distance function as a measure of evenness of a rhythm is that when two onsets are close together, they have a small pairwise distance.
    Thus, when all the onsets are spread out as far as possible, there should be more total distance between pairs.
    This intuition is formally proved to be correct by Demaine et al., but we will omit their proof as it would be a major detour from our primary focus of applying the Euclidean algorithm to create rhythms.
    For our purposes, we will accept as a fact that maximizing this function is a good way to maximize evenness of a rhythm.
  </p>

  <exercise>
    <p>
      Consider the rhythm given by the sequence <m>(1,1,2)</m> corresponding to the box-like <m>[\times \times \times \cdot ]</m>, which corresponds to 
      <md>
        R=\{1,2,3\}\subset \{1,2,3,4\} 
      </md>
      having the three points
      <md>
        (0,1), (1,0), (0,-1)
      </md>
      on the unit circle.
      Compute the sum of pairwise distance function for this rhythm.
    </p>
  </exercise>

  <p>
    As another example, for the tresillo rhythm, we have <m>R=\{1,4,7\}</m> and therefore we have
    <md>
      <mrow>\mathrm{pairdist}(R) \amp =\textrm{dist}(P_1,P_4)+\textrm{dist}(P_1,P_7)+\textrm{dist}(P_4,P_7)</mrow>
      <mrow> \amp \approx 5.1097</mrow>
    </md>
  </p>

  <p>
    We are now in a position to distinguish between the clave son and Bossa-Nova rhythms. 
    The clave son has sum of pairwise distance function value
    <md>
      15.282
    </md>
    while the Bossa-Nova has sum of pairwise distance function value
    <md>
      15.325 \, .
    </md>
    Therefore, the Bossa-Nova is closer to even spacing when measured using the sum of pairwise distance function.    
    This matches our intuition from looking at the clock diagrams.
  </p>

  <p>
    Our goal in the next subsection is to describe a process based on the Euclidean algorithm that generates maximally-even rhythmic patterns.
    The main result of the article by Demaine et al. is that every maximally-even rhythmic pattern is generated by this process, up to rotation of the clock diagram.
    If you want to experiment with the sum of pairwise distance function, here is sagemath code that you can use and adapt.
  </p>

  <program language="python">
    <input>
def pointin(i,n):
    return([cos(pi/2-2*pi*(i-1)/n),sin(pi/2-2*pi*(i-1)/n)])

def distfn(K,T):
    [a,b] = K
    [c,d] = T
    return(sqrt((a-c)^2+(b-d)^2))

def pairwisedistsum(R):
    dists = []
    for i in range(0,len(R)-1):
        for j in range(i+1,len(R)):
            dists.append(distfn(R[i],R[j]))
    return(N(sum(dists)))

n = 16
onsets = [1,4,7,11,13]
R = [pointin(j,n) for j in onsets]
pairwisedistsum(R)
    </input>
  </program>



</section>