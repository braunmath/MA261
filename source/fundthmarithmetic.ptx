<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="fundthmarithmetic" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>The Fundamental Theorem of Arithmetic</title>

  <p>
    <xref ref="thm-primesdividenumbers"/> established that every natural number greater than <m>1</m> is divisible by a prime.
    This leads to a question: exactly which primes divide a natural number?
    Is it possible to give two different sets of primes that multiply together to give the same number?
  </p>

  <p>
    The answer to this question is the following, which is something most of you learned as a "fact" in elementary and middle school.
  </p>

  <theorem xml:id="thm-fundthmarithmetic">
    <title>The Fundamental Theorem of Arithmetic</title>
    <statement>
      <p>
        Every natural number greater than <m>1</m> can be written as a product of primes, and this product is unique for each number.
        Symbolically, given a natural number <m>n\gt 1</m>, there exist distinct primes <m>p_1,\ldots,p_k</m> and exponents <m>a_1,\ldots,a_k\in \mathbb{N}</m> such that
        <me>
          n = p_1^{a_1}p_2^{a_2}\cdots p_k^{a_k}
        </me>
        and the primes and exponents are unique up to reordering of factors.
      </p>
    </statement>
  </theorem>

  <exercise>
    <p>
      Find the prime factorizations for the following numbers.
      <ol>
        <li>
          <p>
            <m>380</m>
          </p>
        </li>
        <li>
          <p>
            <m>927</m>
          </p>
        </li>
        <li>
          <p>
            <m>708</m>
          </p>
        </li>
      </ol>
    </p>
  </exercise>

  <p>
    We will prove existence of factorizations and uniqueness of factorizations separately.
    This proof closely follows the structure of the proof given in <url href="https://bookstore.ams.org/view?ProductCode=AMSTEXT/58">Theorem 1.6.5 in Cioaba and Linde's <em>A Bridge to Advanced Mathematics</em></url>.
  </p>
  
  <proof>
    <title>Proof of existence of prime factorizations</title>
    <p>
      First, we will show that such a factorization exists, using strong induction.
      Our base case is <m>n=2</m>, which is prime.
      For the (strong) induction step, let <m>m</m> be a positive integer and assume that every natural number <m>1\leq k\leq m</m> has a prime factorization.
      We want to prove that <m>m+1</m> also has a prime factorization.
      If <m>m+1</m> is prime, then we are done.
      If not, then <m>m+1</m> must have some prime divisor <m>p</m> such that <m>1\lt p\lt m+1</m>, so that means there exists a number <m>c</m> such that
      <me>
        m+1=cp \, .
      </me>
      By induction, <m>c</m> has a prime factorization 
      <me>
        c=p_1^{a_1}p_2^{a_2}\cdots p_k^{a_k}\, .
      </me>
      If we multiply this by <m>p</m>, we obtain a prime factorization for <m>m+1</m>.
      Therefore, prime factorizations exist by induction.
    </p>
  </proof>

  <exercise>
    <p>
            Discuss the proof of existence using strong induction.
            What are the 2-3 key ideas that make this proof work?
    </p>
  </exercise>

  <exercise>
    <p>
      Draw a picture or diagram that illustrates the inductive process of this proof.
    </p>
  </exercise>

  <p>
    Remember that when we introduced the principle of mathematical induction in <xref ref="principle-induction"/>, we did not give a proof for it.
    That is because the principle of mathematical induction is, for us in this course, an <alert>axiom</alert> that we take as given.
    In the formal world, mathematics is the study of <alert>correctness</alert> within logical systems, rather than being the study of reality or truth.
    So, in the formal world, we make certain assumptions (called "axioms") and then see what logical implications follow from these.
  </p>

  <p>
    Different areas of mathematics rely to different degrees on the embodied, symbolic, and formal worlds of mathematics.
    Number theory is usually practiced by mathematicians through a blending of these three worlds, rather than being rigidly maintained within the formal world.
    So, we will use the following principle in this course.
  </p>

  <principle xml:id="principle-balancedworlds">
    <statement>
      <p>
        In our development of number theory, we will rely on a mix of embodied, symbolic, and formal arguments.
        While we will not work purely in the formal world, we will regularly introduce axioms or fundamental principles of mathematics that are foundational to the formal world, so that students gain experience with the level of detail required when constructing very formal arguments.
      </p>
    </statement>
  </principle>

  <p>
    For our proof of uniqueness of prime factorizations, we will use a proof by contradiction.
    It will have five steps.
    <ol>
      <li>
        <p>
          Step 1: Assume for a contradiction that there is some natural number that has two distinct prime factorizations.
        </p>
      </li>
      <li>
        <p>
          Step 2: Consider the smallest natural number <m>N</m> that has this property.
        </p>
      </li>
      <li>
        <p>
          Step 3: Use the two different factorizations of <m>N</m> to construct a natural number <m>n</m> that is strictly less than <m>N</m>, so by assumption it has a unique prime factorization.
        </p>
      </li>
      <li>
        <p>
          Step 4: Use the unique factorization of <m>n</m> to prove that there are two primes <m>p_1</m> and <m>q_1</m> such that <m>p_1\mid q_1</m>, which is impossible.
        </p>
      </li>
      <li>
        <p>
          Step 5: Conclude that our assumption was faulty, and therefore every number has a unique prime factorization.
        </p>
      </li>
    </ol>
  </p>

  <exercise>
    <p>
      Discuss the 5-step strategy we will use for the proof.
      Does it make sense why this argument will logically imply that every number has a unique prime factorization?
      Why or why not?
    </p>
  </exercise>

  <p>
    Note that in Step 2, we made an assumption that given a set of natural numbers with some property, there is a smallest number in the set.
    This makes sense intuitively, because the smallest natural number is <m>1</m>, and so in principle you could start at <m>1</m> and check to see if it has the property, then check <m>2</m>, then check <m>3</m>, and so on until you find the first element in the set.
    However, in the formal world of mathematical proof, mathematicians want to know if this intuitive idea follows logically from another assumption we make about numbers, or if we should consider it as an independent principle.
    So, mathematicians asserted the following principle to formally allow this step in the proof.
  </p>

  <principle xml:id="principle-wellorderingprinciple">
    <title>Well-Ordering Principle</title>
    <statement>
      <p>
        Every non-empty subset of the natural numbers contains a smallest element, which is sometimes called the <em>least element</em> of the set.
      </p>
    </statement>
  </principle>

  <p>
    If you study formal axiomatic mathematics in more detail, you will find that the well-ordering principle and the principle of mathematical induction are equivalent.
    In other words, you can use the well-ordering principle to prove that induction is correct, and you can use induction to prove that well-ordering holds.
    In this course, we will take both of these as axiomatic principles, and we will direct our focus on proving number-theoretic results that they imply.
  </p>

  <proof>
    <title>Proof of uniqueness of prime factorizations</title>    
    <p>
      We now show that each natural number has a unique prime factorization, using a proof by contradiction.
      Assume for contradiction that this is not true, and suppose that <m>N</m> is the least natural number that has two distinct prime factorizations.
      So, suppose that there exist prime numbers <m>p_1\lt \cdots \lt p_t</m> and <m>q_1\lt \cdots \lt q_s</m> and natural numbers <m>a_1,\ldots,a_t,b_1,\ldots,b_s</m>
      such that
      <me>
        N=p_1^{a_1}\cdots p_t^{a_t}=q_1^{b_1}\cdots q_s^{b_s} \, .
      </me>
    </p>
    <p>
      Our first observation is that the <m>p_i</m>'s are all distinct from the <m>q_j</m>'s.
      This is because if there was a common prime factor <m>p</m> in the two factorizations, we could divide by that factor to produce a new number <m>n=N/p</m> that would be smaller than <m>N</m> and would have two different prime factorizations.
      So, there are no common primes between the two factorizations.
    </p>
    <p>
      We can assume that <m>p_1\lt q_1</m>, since if it isn't we can exchange the names of the <m>p_i</m> and <m>q_j</m>.
      Define
      <me>
        n:=N-p_1q_1^{b_1-1}q_2^{b_2}q_3^{b_3}\cdots q_s^{b_s} \, ,
      </me>
      which is obtained by replacing one copy of <m>q_1</m> with <m>p_1</m>.
      We can then substitute our two factorizations of <m>N</m> into this expression to get two different expressions for <m>N</m>:
      <md>
        <mrow>n \amp = p_1^{a_1}\cdots p_t^{a_t} - p_1q_1^{b_1-1}q_2^{b_2}q_3^{b_3}\cdots q_s^{b_s} </mrow>
        <mrow> \amp = p_1(p_1^{a_1-1}\cdots p_t^{a_t} - q_1^{b_1-1}q_2^{b_2}q_3^{b_3}\cdots q_s^{b_s})</mrow>
      </md>
      and
      <md>
        <mrow>n \amp = q_1^{b_1}\cdots q_s^{b_s} - p_1q_1^{b_1-1}q_2^{b_2}q_3^{b_3}\cdots q_s^{b_s}</mrow>
        <mrow> \amp = (q_1-p_1)q_1^{b_1-1}q_2^{b_2}q_3^{b_3}\cdots q_s^{b_s}\, . </mrow> 
      </md>
    Notice that <m>n</m> is less than <m>N</m>, because it is created by subtracting a positive value from <m>N</m>.
    Therefore, <m>n</m> has a unique factorization.
    </p>
    <p>
      From the first expression, we see that <m>p_1</m> is a prime divisor of <m>n</m>.
      Since <m>p_1</m> is not equal to any of the <m>q_j</m> values, it must be that <m>p_1\mid (q_1-p_1)</m>, and hence there is a natural number <m>c</m> such that
      <me>
        c\cdot p_1 = (q_1-p_1) \, .
      </me>
      Therefore, we have that
      <me>
        (c+1)\cdot p_1 = c\cdot p_1 + p_1 = (q_1-p_1)+p_1 = q_1 \, .
      </me>
      Thus, we have found that the prime <m>p_1</m> divides the prime <m>q_1</m>, which is a contradiction.
      Therefore, every natural number has a unique prime factorization.
    </p>
  </proof>

  <exercise>
    <p>
      <ol>
        <li>
          <p>
            Review the proof with your group, matching up each of steps 1-5 with the corresponding section of the proof.
          </p>
        </li>
        <li>
          <p>
            Discuss the details of each section of this proof.
            Does each step make sense? Why or why not?
          </p>
        </li>
      </ol>
    </p>
  </exercise>

  <p>
    While the fundamental theorem of arithmetic might seem obvious, the above proof shows that it it not as obvious as it seems.
    Further, the existence and uniqueness of prime factorization unlocks subtle and deep questions in mathematics.
    One of these questions is the "Mertens Conjecture", a conjecture that was stated in 1885 by Stieltjes and which was proved false in 1985 by Odlyzko and te Riele.
    Let's watch the following 9-minute Numberphile video from January 2020 in which Dr. Holly Krieger discusses Merterns' Conjecture.
  </p>

  <p>
    <url href="https://www.youtube.com/watch?v=uvMGZb0Suyc">A Prime Surprise (Mertens Conjecture) - Numberphile </url>
  </p>

  <exercise>
    <p>
      <ol>
        <li>
          <p>
            What stood out to you about the mathematics in the video?
            Did anything surprise you?
          </p>
        </li>
        <li>
          <p>
            Did you find the story of the Mertens conjecture interesting? Why or why not?
          </p>
        </li>
        <li>
          <p>
            What aspects of embodied, symbolic, and formal mathematics are present in this video?
          </p>
        </li>
      </ol>
    </p>
  </exercise>

</section>