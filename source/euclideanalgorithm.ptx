<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="euclideanalgorithm" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>The Euclidean Algorithm</title>

  <p>
    We started the previous section by looking at linear Diophantine equations of the form <me>ax + by = c</me>, where <m>a</m>, <m>b</m>, and <m>c</m> are given integers and we want to find integer solutions <m>x,y</m>.
    What we observed is that there seems to be a connection between the solvability of this equation and the greatest common divisor of <m>a</m> and <m>b</m>, which we will establish in detail later in this chapter.
    In this section, we will develop the theory of greatest common divisors using the division algorithm, which we will need for our study of linear Diophantine equations.
  </p>

  <p>
    Recall that in <xref ref="prop-gcdlcmfactorizations"/> we showed how to compute the greatest common divisor of two numbers if you know the prime factorizations of those numbers.
    Unfortunately, it is famously difficult to find the prime factorization of large numbers.
    In fact, the security of many modern cryptographic systems relies on this difficulty, see <url>https://en.wikipedia.org/wiki/Integer_factorization</url> for more information.
    So, we need to find a better way to compute greatest common divisors without having to factor the numbers first.
  </p>

  <p>
    Fortunately, this was first accomplished by the ancient Greek mathematician Euclid around 300 BC.
    This is the same Euclid who wrote <em>The Elements</em>, one of the most influential works in the history of mathematics, and whose proof of the infinitude of primes we saw previously in the course.
  </p>

  <p>
    The idea of the Euclidean algorithm is to apply the division algorithm repeatedly.
    Why does this help us?
    It is because the division algorithm is closely related to the greatest common divisor, as the following lemma shows.
  </p>

  <lemma xml:id="lem-divisionalgorithmgcd">
    <statement>
      <p>
        Let <m>a</m> and <m>b</m> be positive integers and use the division algorithm to write <me>a = bq + r</me> for some integers <m>q</m> and <m>r</m> with <m>0 \leq r\lt b</m>.
        Then <me>\gcd(a,b) = \gcd(b,r)</me>.
      </p>
    </statement>
  </lemma>

  <p>
    Let's look at an example. 
    Suppose <m>a=15</m> and <m>b=6</m>.
    Using the division algorithm, we can write <me>15 = 6 \cdot 2 + 3</me>.
    According to the lemma, we have <me>\gcd(15,6) = 3 = \gcd(6,3)</me>.
  </p>

  <exercise>
    <p>
      Verify the lemma on the following pairs.
      You might want to use <url>https://sagecell.sagemath.org/</url> with the command <code>gcd(a,b)</code> to help find the greatest common divisors.
      Also, the command <code>a % b</code> computes the remainder when <m>a</m> is divided by <m>b</m>.
      Finally, the command <code>N(a/b)</code> computes the decimal approximation to the quotient <m>a/b</m>, which you can round down to find <m>q</m>. 
      <ol>
        <li>
          <p>
            <m>a=28</m>, <m>b=12</m>
          </p>
        </li>
        <li>
          <p>
            <m>a=1071</m>, <m>b=462</m>
          </p>
        </li>
        <li>
          <p>
            <m>a=26435</m>, <m>b=7578</m>
          </p>
        </li>
      </ol>
    </p>
  </exercise>

  <proof>
    <p>
      We first show that any common divisor of <m>a</m> and <m>b</m> is also a common divisor of <m>b</m> and <m>r</m>.
      Let <m>d</m> be a common divisor of <m>a</m> and <m>b</m>.
      Then <me>a = dm_1</me> and <me>b = dm_2</me> for some integers <m>m_1</m> and <m>m_2</m>.
      Substituting into the equation <me>a = bq + r</me> gives <me>dm_1 = dm_2 q + r</me>, which implies <me>r = d(m_1 - m_2 q)</me>.
      Thus, <m>d</m> divides <m>r</m>, and so <m>d</m> is a common divisor of <m>b</m> and <m>r</m>. 
    </p>
    <p>
      We next show that any common divisor of <m>b</m> and <m>r</m> is also a common divisor of <m>a</m> and <m>b</m>.
      Let <m>d</m> be a common divisor of <m>b</m> and <m>r</m>.
      Then <me>b = dm_2</me> and <me>r = dm_3</me> for some integers <m>m_2</m> and <m>m_3</m>.
      Substituting into the equation <me>a = bq + r</me> gives <me>a = dm_2 q + dm_3</me>, which implies <me>a = d(m_2 q + m_3)</me>.
      Thus, <m>d</m> divides <m>a</m>, and so <m>d</m> is a common divisor of <m>a</m> and <m>b</m>. 
    </p>
    <p>
      Since the sets of common divisors of <m>a</m> and <m>b</m> and of <m>b</m> and <m>r</m> are the same, their greatest common divisors must also be the same.
    </p>
  </proof>

  <exercise>
    <p>
      Discuss this proof with your group. Does it make sense? Why or why not?
    </p>
  </exercise>

  <p>
    So, how does the Euclidean algorithm work?
    It works by allowing us to replace the pair <m>(a,b)</m> by the smaller pair <m>(b,r)</m> without changing the greatest common divisor.
    We can repeat this process until the remainder is zero.
    At that point, the other number is the greatest common divisor.
    Let's do an example before we write down the algorithm formally.
  </p>

  <p>
    Suppose <m>a=2542</m> and <m>b=1056</m>.
    <ul>
      <li>
        <p>
          Using the division algorithm, we have <me>2542 = 1056 \cdot 2 + 430</me>.
    Thus, <me>\gcd(2542,1056) = \gcd(1056,430).</me> 
        </p>
      </li>
      <li>
        <p>
              Next, we apply the division algorithm again to get <me>1056 = 430 \cdot 2 + 196</me>.
              So, <m>\gcd(1056,430) = \gcd(430,196)</m>.
        </p>
      </li>
      <li>
        <p>
          Next, we have <me>430 = 196 \cdot 2 + 38</me>, so <m>\gcd(430,196) = \gcd(196,38)</m>.
        </p>
      </li>
      <li>
        <p>
          Next, we have <me>196 = 38 \cdot 5 + 6</me>, so <m>\gcd(196,38) = \gcd(38,6)</m>.
        </p>
      </li>
      <li>
        <p>
          Next, we have <me>38 = 6 \cdot 6 + 2</me>, so <m>\gcd(38,6) = \gcd(6,2)</m>.
        </p>
      </li>
      <li>
        <p>
          Finally, we have <me>6 = 2 \cdot 3 + 0</me>, so <m>\gcd(6,2) = 2</m>.
          Thus, tracing back through all the equalities of the gcd's, we have 
          <me>\gcd(2542,1056) = 2 \, .</me>
        </p>
      </li>
    </ul>
  </p>

  <exercise>
    <p>
      Discuss this example with your group. Does it make sense? Why or why not?
    </p>
  </exercise>

  <exercise>
    <p>
      Use this approach to compute the greatest common divisor of <m>5234</m> and <m>1435</m>.
    </p>
  </exercise>

  <p>
    Let's now give a formal description of the Euclidean algorithm.
  </p>

  <algorithm xml:id="alg-euclideanalgorithm">
    <title>The Euclidean Algorithm</title>
    <statement>
      <p>
        Suppose that <m>a</m> and <m>b</m> are positive integers with <m>a \geq b</m>.
        The Euclidean algorithm computes <m>\gcd(a,b)</m> as follows:
        <ol>
          <li>
            <p>
              Use the division algorithm to write <me>a = bq_1 + r_1</me> for some integers <m>q_1</m> and <m>r_1</m> with <m>0 \leq r_1 \lt b</m>.
            </p>
          </li>
          <li>
            <p>
              If <m>r_1 = 0</m>, then stop and output <m>b</m> as the greatest common divisor.
              Otherwise, continue to the next step.
            </p>
          </li>
          <li>
            <p>
              Use the division algorithm to write <me>b = r_1 q_2 + r_2</me> for some integers <m>q_2</m> and <m>r_2</m> with <m>0 \leq r_2 \lt r_1</m>.
            </p>
          </li>
          <li>
            <p>
              If <m>r_2 = 0</m>, then stop and output <m>r_1</m> as the greatest common divisor.
              Otherwise, continue to the next step.
            </p>
          </li>
          <li>
            <p>
              Continue this process, at each step using the division algorithm to divide the previous divisor by the previous remainder, until a remainder of zero is obtained.
              The last nonzero remainder is the greatest common divisor <m>\gcd(a,b)</m>.
            </p>
          </li>
        </ol>
      </p>
    </statement>
  </algorithm>

  <proof>
    <p>
      The correctness of the algorithm follows by repeated application of <xref ref="lem-divisionalgorithmgcd"/>.
    </p>
  </proof>

  <p>
    Let's think a little bit about the practical efficiency of the Euclidean algorithm.
    Intuitively, if we have a step where the quotient <m>q</m> is large, then we quickly reduce the size of the numbers we are working with.
    On the other hand, if the quotients are all small, then we reduce the size of the numbers more slowly.
    So, what happens in the case where every quotient is as small as possible, that is, every quotient is equal to 1?
  </p>

  <p>
    Suppose that <m>\gcd(a,b)=1</m> and that every quotient in the Euclidean algorithm is equal to 1.
    Suppose that with our first step we have <me>a = b \cdot 1 + r_1</me>, and with our second step we have <me>b = r_1 \cdot 1 + r_2</me>, and with our third step we have <me>r_1 = r_2 \cdot 1 + r_3</me>, and so on.
    Eventually, we will reach a final step where <me>r_{n-1} = r_{n} \cdot 1 + 0</me>, so that <m>r_{n} = \gcd(a,b) = 1</m>.
    If we rewrite all of these equations, we get that <me>r_{n} = 1</me>, <me>r_{n-1} = 1 + 0 = 1</me>, <me>r_{n-2} = 1 + 1 = 2</me>, <me>r_{n-3} = 2 + 1 = 3</me>, <me>r_{n-4} = 3 + 2 = 5</me>, <me>r_{n-5} = 5 + 3 = 8</me>, and so on.
    In other words, we start with the numbers <m>1</m> and <m>1</m>, and each new number is the sum of the previous two numbers.
  </p>

  <exercise>
    <p>
      Discuss this computation. Does it make sense? Why or why not?
    </p>
  </exercise>

  <p>
    The numbers that arise from this process are the following.
  </p>

  <definition xml:id="def-fibonaccinumbers">
    <statement>
      <p>
        Let <m>F_0 = 1</m> and <m>F_1 = 1</m>, and for each integer <m>n \geq 2</m>, let <me>F_n = F_{n-1} + F_{n-2}</me>.
        The resulting sequence of numbers <m>F_0, F_1, F_2, \ldots</m> are called the <em>Fibonacci numbers</em>.
      </p>
    </statement>
  </definition>

  <p>
    Our calculation above proves the following theorem.
  </p>

  <theorem xml:id="thm-fibonaccieuclidean">
    <statement>
      <p>
        If the Euclidean algorithm is applied to two relatively prime positive integers <m>a</m> and <m>b</m> with <m>a \geq b</m> and every quotient in the algorithm is equal to <m>1</m>, then <m>a</m> and <m>b</m> are consecutive Fibonacci numbers.
      </p>
    </statement>
  </theorem>

  <p>
    In the next section, we will investigate a connection between the Euclidean algorithm and linear Diophantine equations.
  </p>





  

</section>